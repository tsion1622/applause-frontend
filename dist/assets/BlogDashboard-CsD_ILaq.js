import{f as k,r as g,j as e,B as d,d as w,b as u}from"./index-C033NPT0.js";import{u as B}from"./useQuery-O-qZ9aku.js";import{u as P}from"./useMutation-BBYY9Llb.js";import{I as S}from"./Input-CsQmvcEd.js";import{T as _}from"./textarea-BaCDY8Kw.js";import{C as p,c as b,d as j,a as f}from"./Card-BcSRCw2q.js";import{u as y}from"./index-b5uPlb3-.js";const q=async()=>{const{data:a}=await u.get("/blog/posts/");return a},F=async a=>{const{data:i}=await u.post("/blog/posts/",a);return i},E=async a=>{const{id:i,...l}=a,{data:s}=await u.put(`/blog/posts/${i}/`,l);return s},K=()=>{const a=k(),[i,l]=g.useState(!1),[s,n]=g.useState(null),{data:r,isLoading:C}=B({queryKey:["blogPosts"],queryFn:q}),c=P({mutationFn:t=>s!=null&&s.id?E({...t,id:s.id}):F(t),onSuccess:()=>{a.invalidateQueries({queryKey:["blogPosts"]}),y.success(`Blog post ${s!=null&&s.id?"updated":"created"} successfully!`),l(!1),n(null)},onError:t=>{y.error(`Failed to ${s!=null&&s.id?"update":"create"} blog post: ${t.message}`)}}),m=(t=null)=>{n(t||{title:"",content:"",is_published:!1}),l(!0)},v=t=>{t.preventDefault(),s&&c.mutate(s)},x=t=>{const{name:o,value:N}=t.target;n(h=>h?{...h,[o]:N}:null)};return e.jsxs("div",{className:"container mx-auto p-4 md:p-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Blog Management"}),e.jsx(d,{onClick:()=>m(),children:"Create New Post"})]}),C&&e.jsx(w,{className:"mx-auto h-12 w-12 animate-spin"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r==null?void 0:r.map(t=>e.jsxs(p,{children:[e.jsx(b,{children:e.jsx(j,{children:t.title})}),e.jsxs(f,{children:[e.jsxs("p",{className:"mb-4",children:["Status: ",t.is_published?"Published":"Draft"]}),e.jsx(d,{variant:"outline",onClick:()=>m(t),children:"Edit"})]})]},t.id))}),i&&s&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center",children:e.jsxs(p,{className:"w-full max-w-2xl",children:[e.jsx(b,{children:e.jsxs(j,{children:[s.id?"Edit":"Create"," Blog Post"]})}),e.jsx(f,{children:e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"Title"}),e.jsx(S,{id:"title",name:"title",value:s.title,onChange:x,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"content",className:"block text-sm font-medium text-gray-700",children:"Content"}),e.jsx(_,{id:"content",name:"content",value:s.content,onChange:x,rows:10,required:!0})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"is_published",name:"is_published",checked:s.is_published,onChange:t=>n(o=>o?{...o,is_published:t.target.checked}:null),className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),e.jsx("label",{htmlFor:"is_published",className:"ml-2 block text-sm text-gray-900",children:"Publish"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(d,{type:"button",variant:"ghost",onClick:()=>l(!1),children:"Cancel"}),e.jsx(d,{type:"submit",disabled:c.isPending,children:c.isPending?"Saving...":"Save Post"})]})]})})]})})]})};export{K as default};
